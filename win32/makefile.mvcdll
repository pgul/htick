# $Id$
# Legacy makefile to build dll version of htick with Microsoft Visual C++

CC=     cl
CFLAGS= -nologo -MD -Zp1 -I..\.. -I..\h -I..\..\fidoconf -I..\..\smapi -I..\..\huskylib
CDEFS=  -D__NT__ -DNT -DWINNT -D_CONSOLE -D_MAKE_DLL

# uncomment one of these lines if you want to enable hardlinking on NTFS 4.0, 5.0
# CDEFS=  $(CDEFS) -D_WIN32_WINNT=0x0400
# CDEFS=  $(CDEFS) -D_WIN32_WINNT=0x0500

COPT=   -O2
TLIB=   lib -nologo

FCONFL=	..\..\fidoconf\fconfmvc.lib
SMAPIL=	..\..\smapi\make\smapimvc.lib ..\..\huskylib\make\huskymvc.lib
HTICKL=	htickmvc.lib

OBJS    = global.obj \
          toss.obj \
          fcommon.obj \
          scan.obj \
          areafix.obj \
          add_desc.obj \
          seenby.obj \
          hatch.obj \
          filelist.obj\
          filecase.obj\
          report.obj\
          clean.obj

{..\src}.c.obj:
	$(CC) $(CFLAGS) $(CDEFS) $(COPT) -c $<

all: $(HTICKL) htick.exe

$(HTICKL): $(OBJS)
	$(TLIB) /out:$@ $(OBJS)

htick.exe:
        $(CC) $(CFLAGS) $(COPT) $(CDEFS) -Fe$@ ..\src\htick.c $(FCONFL) $(SMAPIL) $(HTICKL) USER32.LIB msvcrt.lib Kernel32.lib /link /opt:nowin98

clean:
	-del *.obj
	-del *.lib

distclean: clean
	-del *.exe
